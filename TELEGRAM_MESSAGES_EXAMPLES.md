# 📱 Примеры уведомлений в Telegram

---

## 🆕 **НОВЫЙ ТЕНДЕР**
### Когда: При добавлении нового тендера
### Галочка: ☑ Новый тендер

```
🆕 Новый тендер

━━━━━━━━━━━━━━━━━━
📌 Строительство школы №15

💰 Начальная цена: 5 000 000 ₽
📍 Регион: Москва
⏰ Дедлайн: 15.11.2024
⏳ Осталось: через 5 дней

[🌐 Открыть в CRM]
```

**Умная логика:**
- Показывает только если есть данные
- Динамический подсчёт дней: "завтра", "сегодня!", "просрочено на 2 дня!"

---

## 📤 **ЗАЯВКА ПОДАНА**
### Когда: Статус меняется на "Подано"
### Галочка: ☑ Другие изменения

```
📤 Заявка подана!

━━━━━━━━━━━━━━━━━━
📌 Строительство школы №15

💵 Начальная: 5 000 000 ₽
💸 Наша цена: 4 850 000 ₽
📊 Экономия: 150 000 ₽ (-3.0%)

⏰ Дедлайн: 15.11.2024 (через 5 дней)

Ждём результатов! 🤞

[🌐 Открыть в CRM]
```

**Умная логика:**
- Автоподсчёт экономии (начальная - наша)
- Автоподсчёт процента
- Показывает сравнение только если есть обе цены

---

## 🔍 **НА РАССМОТРЕНИИ**
### Когда: Статус меняется на "На рассмотрении"
### Галочка: ☑ Другие изменения

```
🔍 Тендер на рассмотрении

━━━━━━━━━━━━━━━━━━
📌 Строительство школы №15

📅 Подано: 10.11.2024
⏰ Дедлайн: 15.11.2024 (через 5 дней)
💸 Наша цена: 4 850 000 ₽

Ожидаем решения заказчика...

[🌐 Открыть в CRM]
```

---

## 🎉 **ПОБЕДА!**
### Когда: Статус меняется на "Победа"
### Галочка: ☑ Победа

```
🎉🎉🎉 ПОБЕДА! 🎉🎉🎉

━━━━━━━━━━━━━━━━━━
✅ Строительство школы №15

💰 Сумма контракта: 4 850 000 ₽
📊 Экономия: 150 000 ₽ (-3.0%)

🔥 ПОЗДРАВЛЯЕМ! 🔥

[🌐 Открыть в CRM]
```

**Важно:**
- Показываем ЭКОНОМИЮ от начальной цены (не прибыль!)
- В момент победы расходов ещё нет
- Много эмодзи для радости 🎉🔥

---

## 😔 **ПРОИГРЫШ**
### Когда: Статус меняется на "Проигрыш"
### Галочка: ☑ Проигрыш

```
😔 Не выиграли тендер

━━━━━━━━━━━━━━━━━━
📌 Строительство школы №15

💸 Наша цена: 4 850 000 ₽

Не расстраивайтесь!
Впереди новые возможности 💪
```

**Логика:**
- Минимум информации
- Мотивация команды

---

## ⚙️ **В РАБОТЕ**
### Когда: Статус меняется на "В работе"
### Галочка: ☑ Другие изменения

```
⚙️ Работы начались

━━━━━━━━━━━━━━━━━━
📌 Строительство школы №15

💰 Сумма контракта: 4 850 000 ₽
📅 Начало: 20.11.2024

Удачи команде! 🚀

[🌐 Открыть в CRM]
```

---

## ✅ **ЗАВЕРШЁН**
### Когда: Статус меняется на "Завершён"
### Галочка: ☑ Другие изменения

### Вариант 1: С расходами в БД
```
✅ Проект завершён!

━━━━━━━━━━━━━━━━━━
📌 Строительство школы №15

💰 Контракт: 4 850 000 ₽
💸 Расходы: 4 400 000 ₽
💵 Прибыль: 450 000 ₽ (9.3%)

🎊 ОТЛИЧНАЯ РАБОТА! 🎊

[🌐 Открыть в CRM]
```

### Вариант 2: Без расходов
```
✅ Проект завершён!

━━━━━━━━━━━━━━━━━━
📌 Строительство школы №15

💰 Контракт: 4 850 000 ₽

🎊 ОТЛИЧНАЯ РАБОТА! 🎊

[🌐 Открыть в CRM]
```

**Умная логика:**
- Реальные расходы из таблицы `expenses`
- Автоподсчёт: `SUM(amount) WHERE tender_id = X`
- Если расходов нет - не показываем блок прибыли
- Прибыль = Контракт - Расходы

---

## 🔄 **ДРУГИЕ СТАТУСЫ**
### Когда: Любой другой статус
### Галочка: ☑ Другие изменения

```
🔄 Изменение статуса

━━━━━━━━━━━━━━━━━━
📌 Строительство школы №15

Было: новый
Стало: кастомный статус

[🌐 Открыть в CRM]
```

---

## 🎨 **ЭЛЕМЕНТЫ ОФОРМЛЕНИЯ**

### HTML теги (работают в Telegram):
```html
<b>Жирный текст</b>
<i>Курсив</i>
<code>Моноширинный (цены)</code>
<pre>Блок кода</pre>
```

### Эмодзи:
```
━━━━━━━━━━━━━━━━━━  - Разделитель
📌 - Название
💰 💵 💸 - Деньги (разные для различия)
📊 - Статистика
⏰ ⏳ 📅 - Время
📍 - Локация
🎉 🔥 🎊 💪 🤞 🚀 - Эмоции
✅ ❌ 🔍 ⚙️ 📤 🆕 - Статусы
```

---

## 🧠 **УМНЫЕ ФУНКЦИИ**

### 1. Динамические дни до дедлайна:
```javascript
5+ дней → "через 5 дней"
1 день → "завтра"
0 дней → "сегодня!"
-1 день → "вчера (просрочено!)"
-5 дней → "просрочено на 5 дней!"
```

### 2. Подсчёт экономии:
```javascript
Экономия = Начальная цена - Наша цена
Процент = (Экономия / Начальная) * 100
```

### 3. Подсчёт прибыли (только для "Завершён"):
```javascript
Расходы = SUM(expenses.amount WHERE tender_id = X)
Прибыль = Контракт - Расходы
Процент = (Прибыль / Контракт) * 100
```

### 4. Адаптивность:
- Нет начальной цены? → Не показываем сравнение
- Нет расходов? → Не показываем прибыль
- Нет дедлайна? → Не показываем дни
- Нет submitted_price? → Не показываем цену

---

## ✅ **ИТОГО**

**7 разных типов уведомлений:**
1. 🆕 Новый тендер
2. 📤 Заявка подана
3. 🔍 На рассмотрении
4. 🎉 Победа
5. 😔 Проигрыш
6. ⚙️ В работе
7. ✅ Завершён

**Каждое - умное, информативное, красивое!** 🚀
